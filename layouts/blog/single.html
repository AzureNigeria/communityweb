{{ define "main" }}
  {{ $postDescription := .Params.excerpt | default .Summary | plainify }}
  {{ $postImage := "" }}
  {{ with .Params.featured_image }}
    {{ $postImage = . | absURL }}
  {{ end }}
  {{ $postSchema := dict "@context" "https://schema.org" "@type" "BlogPosting" "headline" .Title "description" $postDescription "datePublished" (.Date.Format "2006-01-02T15:04:05-07:00") "dateModified" (.Lastmod.Format "2006-01-02T15:04:05-07:00") "author" (dict "@type" "Person" "name" .Params.author) "publisher" (dict "@type" "Organization" "name" .Site.Title "url" .Site.BaseURL) "mainEntityOfPage" (dict "@type" "WebPage" "@id" .Permalink) "url" .Permalink }}
  {{ if $postImage }}
    {{ $postSchema = merge $postSchema (dict "image" (slice $postImage)) }}
  {{ end }}
  <script type="application/ld+json">{{ $postSchema | jsonify }}</script>
  <section class="page-hero">
    <div class="container">
      <p class="breadcrumb"><a href="{{ "/" | relURL }}">Home</a> / <a href="{{ "/blog" | relURL }}">Blog</a></p>
      <h1>{{ .Title }}</h1>
      <div class="hero-badges">
        <span class="badge">{{ .Params.category }}</span>
        <span class="badge"><img src="{{ "images/icons/calendar.svg" | relURL }}" alt="Date icon" />{{ .Date.Format "Jan 02, 2006" }}</span>
        <span class="badge"><img src="{{ "images/icons/user.svg" | relURL }}" alt="Author icon" />{{ .Params.author }}</span>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="container article">
      <article class="content">
        {{ .Content }}
      </article>
      <aside class="sidebar">
        <div class="card author-card">
          <img src="{{ .Params.author_image | relURL }}" alt="{{ .Params.author }}" loading="lazy" decoding="async" />
          <h4>{{ .Params.author }}</h4>
          <p class="muted">Azure Nigeria Community Team</p>
        </div>
        <div class="card">
          <h4>Share</h4>
          {{ $shareText := .Params.description | default (.Summary | plainify) | default .Site.Params.description | plainify | truncate 160 }}
          <button class="btn-secondary share-btn" type="button" data-share data-share-title="{{ .Title }}" data-share-text="{{ $shareText }}" data-share-url="{{ .Permalink }}">
            <img src="{{ "images/icons/share.svg" | relURL }}" alt="" />Share Post
          </button>
        </div>
      </aside>
    </div>
  </section>
  <section class="section section-light">
    <div class="container">
      <h2>Related Posts</h2>
      <div class="grid cards-3">
        {{ range first 3 (where .Site.RegularPages "Section" "blog") }}
          {{ if ne .Permalink $.Permalink }}
            {{ partial "blog-card.html" . }}
          {{ end }}
        {{ end }}
      </div>
    </div>
  </section>
{{ end }}
